{"version":3,"file":"autocomplete.umd.js","sources":["../../sources/js/utils/function.js","../../sources/js/utils/keyCodes.js","../../sources/js/script.js"],"sourcesContent":["/**\r\n * Check is a Object\r\n * @param {Object} value\r\n * @returns {Boolean}\r\n */\r\nconst isObject = (value) =>\r\n  value && typeof value === \"object\" && value.constructor === Object;\r\n\r\n/**\r\n * Check if is a Promise\r\n * https://stackoverflow.com/a/53955664/10424385\r\n *\r\n * @param {Object} value\r\n * @returns {Boolean}\r\n */\r\nconst isPromise = (value) => Boolean(value && typeof value.then === \"function\");\r\n\r\n/**\r\n * Set attributes to element\r\n *\r\n * @param {HTMLElement} el\r\n * @param {Object} object\r\n */\r\nconst setAttributes = (el, object) => {\r\n  for (let key in object) {\r\n    if (key === \"addClass\") {\r\n      el.classList.add(object[key]);\r\n    } else if (key === \"removeClass\") {\r\n      el.classList.remove(object[key]);\r\n    } else {\r\n      el.setAttribute(key, object[key]);\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Get first element from child\r\n *\r\n * @param {HTMLElement} element\r\n * @returns {HTMLELement}\r\n */\r\nconst getFirstElement = (element) => element.firstElementChild || element;\r\n\r\n/**\r\n * Set data from li to input\r\n *\r\n * @param {String} element\r\n * @param {HTMLElement} root\r\n * @returns {String}\r\n */\r\nconst getFirstElementFromLiAndAddToInput = (element, root) =>\r\n  // get first element from li and add to input\r\n  (root.value = getFirstElement(element).textContent.trim());\r\n\r\n/**\r\n * Scroll to top result-list\r\n * @param {HTMLElement} resultList\r\n * @param {HTMLElement} resultWrap\r\n */\r\nconst scrollResultsToTop = (resultList, resultWrap) => {\r\n  // if there is an overflow of ul element, after\r\n  // opening we always move ul to the top of the results\r\n  resultList.scrollTop = resultList.offsetTop - resultWrap.offsetHeight;\r\n};\r\n\r\n/**\r\n * Adding role, tabindex, aria and call handleMouse\r\n *\r\n * @param {HTMLElement} itemsLi\r\n */\r\nconst addAriaToAllLiElements = (itemsLi) => {\r\n  // add role to all li elements\r\n  for (let i = 0; i < itemsLi.length; i++) {\r\n    setAttributes(itemsLi[i], {\r\n      role: \"option\",\r\n      tabindex: \"-1\",\r\n      \"aria-selected\": \"false\",\r\n      \"aria-setsize\": itemsLi.length,\r\n      \"aria-posinset\": i,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Show btn to clear data\r\n *\r\n * @param {HTMLElement} clearButton - button to clear data\r\n * @param {Function} destroy - destroy function\r\n */\r\nconst showBtnToClearData = (clearButton = false, destroy) => {\r\n  if (!clearButton) return;\r\n\r\n  clearButton.classList.remove(\"hidden\");\r\n  // add event to clear button\r\n  clearButton.addEventListener(\"click\", destroy);\r\n};\r\n\r\n/**\r\n * Set aria-activedescendant\r\n *\r\n * @param {HTMLElement} root - search input\r\n * @param {String} type\r\n */\r\nconst setAriaActivedescendant = (root, type) => {\r\n  root.setAttribute(\"aria-activedescendant\", type || \"\");\r\n};\r\n\r\n/**\r\n * Get height of ul without group class\r\n *\r\n * @param {String} outputUl\r\n * @param {String} classGroup\r\n * @returns {Number}\r\n */\r\nconst getClassGroupHeight = (outputUl, classGroup) => {\r\n  // get height of ul without group class\r\n  const allLi = document.querySelectorAll(\r\n    `#${outputUl} > li:not(.${classGroup})`\r\n  );\r\n  let height = 0;\r\n  [].slice.call(allLi).map((el) => (height += el.offsetHeight));\r\n\r\n  // return height\r\n  return height;\r\n};\r\n\r\n/**\r\n * Scroll into view when press up/down arrows\r\n *\r\n * @param {HTMLElement} target\r\n * @param {HTMLElement} outputUl\r\n * @param {String} classGroup\r\n * @param {HTMLElement} resultList\r\n */\r\nconst followActiveElement = (target, outputUl, classGroup, resultList) => {\r\n  const previusElement = resultList.previousSibling;\r\n\r\n  const previusElementHeight = previusElement ? previusElement.offsetHeight : 0;\r\n\r\n  if (target.getAttribute(\"aria-posinset\") == \"0\") {\r\n    resultList.scrollTop =\r\n      target.offsetTop - getClassGroupHeight(outputUl, classGroup);\r\n  }\r\n\r\n  if (target.offsetTop - previusElementHeight < resultList.scrollTop) {\r\n    resultList.scrollTop = target.offsetTop - previusElementHeight;\r\n  } else {\r\n    const offsetBottom =\r\n      target.offsetTop + target.offsetHeight - previusElementHeight;\r\n    const scrollBottom = resultList.scrollTop + resultList.offsetHeight;\r\n    if (offsetBottom > scrollBottom) {\r\n      resultList.scrollTop = offsetBottom - resultList.offsetHeight;\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Create output-list and put after search input\r\n *\r\n * @param {HTMLElement} root - search input\r\n * @param {HTMLElement} resultList - output-list ul\r\n * @param {String} outputUl - id name of output-list\r\n * @param {HTMLElement} resultWrap - wrapper ul element\r\n * @param {String} prefix - add prefix to all class auto\r\n */\r\nconst output = (root, resultList, outputUl, resultWrap, prefix) => {\r\n  // set attribute to results-list\r\n  setAttributes(resultList, {\r\n    id: outputUl,\r\n    tabIndex: \"0\",\r\n    role: \"listbox\",\r\n  });\r\n\r\n  // add class to wrap element\r\n  setAttributes(resultWrap, {\r\n    addClass: `${prefix}-results-wrapper`,\r\n  });\r\n\r\n  // insert the results into the wrap element\r\n  resultWrap.insertAdjacentElement(\"beforeend\", resultList);\r\n\r\n  // insert the wrap element after the search input\r\n  root.parentNode.insertBefore(resultWrap, root.nextSibling);\r\n};\r\n\r\nexport {\r\n  addAriaToAllLiElements,\r\n  followActiveElement,\r\n  getFirstElementFromLiAndAddToInput,\r\n  isObject,\r\n  isPromise,\r\n  output,\r\n  scrollResultsToTop,\r\n  setAriaActivedescendant,\r\n  setAttributes,\r\n  showBtnToClearData,\r\n};\r\n","/**\r\n * Key codes\r\n */\r\nconst keyCodes = {\r\n  ESC: 27,\r\n  ENTER: 13,\r\n  UP: 38,\r\n  DOWN: 40,\r\n  TAB: 9,\r\n};\r\n\r\nexport default keyCodes;\r\n","import {\r\n  addAriaToAllLiElements,\r\n  followActiveElement,\r\n  getFirstElementFromLiAndAddToInput,\r\n  isObject,\r\n  isPromise,\r\n  output,\r\n  scrollResultsToTop,\r\n  setAriaActivedescendant,\r\n  setAttributes,\r\n  showBtnToClearData,\r\n} from \"./utils/function\";\r\n\r\nimport keyCodes from \"./utils/keyCodes\";\r\n\r\n/**\r\n * @class Autocomplete\r\n */\r\nexport default class Autocomplete {\r\n  /**\r\n   * Constructor\r\n   *\r\n   * @param {String} element\r\n   * @param {Object} object\r\n   */\r\n  constructor(\r\n    element,\r\n    {\r\n      delay = 500,\r\n      clearButton = true,\r\n      howManyCharacters = 1,\r\n      selectFirst = false,\r\n      insertToInput = false,\r\n      showAllValues = false,\r\n      cache = false,\r\n      disableCloseOnSelect = false,\r\n      classGroup,\r\n      classPreventClosing,\r\n      classPrefix,\r\n      ariaLabelClear,\r\n      onSearch,\r\n      onResults = () => {},\r\n      onSubmit = () => {},\r\n      onOpened = () => {},\r\n      onReset = () => {},\r\n      onRender = () => {},\r\n      onClose = () => {},\r\n      noResults = () => {},\r\n      onSelectedItem = () => {},\r\n    }\r\n  ) {\r\n    this.id = element;\r\n    this.root = document.getElementById(element);\r\n    this.onSearch = isPromise(onSearch)\r\n      ? onSearch\r\n      : ({ currentValue, element }) =>\r\n          Promise.resolve(onSearch({ currentValue, element }));\r\n    this.onResults = onResults;\r\n    this.onRender = onRender;\r\n    this.onSubmit = onSubmit;\r\n    this.onSelected = onSelectedItem;\r\n    this.onOpened = onOpened;\r\n    this.onReset = onReset;\r\n    this.noResults = noResults;\r\n    this.onClose = onClose;\r\n\r\n    this.delay = delay;\r\n    this.characters = howManyCharacters;\r\n    this.clearButton = clearButton;\r\n    this.selectFirst = selectFirst;\r\n    this.toInput = insertToInput;\r\n    this.showAll = showAllValues;\r\n    this.classGroup = classGroup;\r\n    this.prevClosing = classPreventClosing;\r\n    this.clearBtnAriLabel = ariaLabelClear\r\n      ? ariaLabelClear\r\n      : \"clear text from input\";\r\n    this.prefix = classPrefix ? `${classPrefix}-auto` : \"auto\";\r\n    this.disable = disableCloseOnSelect;\r\n\r\n    // default config\r\n    this.cache = cache;\r\n    this.outputUl = `${this.prefix}-${this.id}-results`;\r\n    this.cacheData = `data-cache-auto-${this.id}`;\r\n    this.isLoading = `${this.prefix}-is-loading`;\r\n    this.isActive = `${this.prefix}-is-active`;\r\n    this.activeList = `${this.prefix}-selected`;\r\n    this.selectedOption = `${this.prefix}-selected-option`;\r\n    this.err = `${this.prefix}-error`;\r\n    this.regex = /[|\\\\{}()[\\]^$+*?.]/g;\r\n    this.timeout = null;\r\n\r\n    this.resultWrap = document.createElement(\"div\");\r\n    this.resultList = document.createElement(\"ul\");\r\n    this.cBtn = document.createElement(\"button\");\r\n\r\n    this.init();\r\n  }\r\n\r\n  /**\r\n   * Initial function\r\n   */\r\n  init = () => {\r\n    const { resultList, root } = this;\r\n\r\n    this.clearbutton();\r\n\r\n    output(root, resultList, this.outputUl, this.resultWrap, this.prefix);\r\n\r\n    // default aria\r\n    // this.reset();\r\n    root.addEventListener(\"input\", this.handleInput);\r\n\r\n    // show all values on click root input\r\n    this.showAll && root.addEventListener(\"click\", this.handleInput);\r\n\r\n    // calback functions\r\n    this.onRender({\r\n      element: root,\r\n      results: resultList,\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Actions on input\r\n   *\r\n   * @param {String} type - set attribute depending on type\r\n   * @param {String} target\r\n   */\r\n  cacheAct = (type, target) => {\r\n    const root = this.root;\r\n    if (!this.cache) return;\r\n\r\n    if (type === \"update\") {\r\n      root.setAttribute(this.cacheData, target.value);\r\n    } else if (type === \"remove\") {\r\n      root.removeAttribute(this.cacheData);\r\n    } else {\r\n      root.value = root.getAttribute(this.cacheData);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handle input\r\n   *\r\n   * @param {Event} object\r\n   */\r\n  handleInput = ({ target, type }) => {\r\n    if (\r\n      this.root.getAttribute(\"aria-expanded\") === \"true\" &&\r\n      type === \"click\"\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    // replace all special characters\r\n    const regex = target.value.replace(this.regex, \"\\\\$&\");\r\n\r\n    // update data attribute cache\r\n    this.cacheAct(\"update\", target);\r\n\r\n    const delay = this.showAll ? 0 : this.delay;\r\n    // clear timeout\r\n    clearTimeout(this.timeout);\r\n    this.timeout = setTimeout(() => {\r\n      this.searchItem(regex.trim());\r\n    }, delay);\r\n  };\r\n\r\n  /**\r\n   * Default aria\r\n   */\r\n  reset = () => {\r\n    // set attributes to root - input\r\n    setAttributes(this.root, {\r\n      \"aria-owns\": `${this.id}-list`,\r\n      \"aria-expanded\": \"false\",\r\n      \"aria-autocomplete\": \"list\",\r\n      \"aria-activedescendant\": \"\",\r\n      role: \"combobox\",\r\n      removeClass: \"auto-expanded\",\r\n    });\r\n\r\n    // remove class isActive\r\n    this.resultWrap.classList.remove(this.isActive);\r\n\r\n    // move the view item to the first item\r\n    // this.resultList.scrollTop = 0;\r\n    // scrollResultsToTop(this.resultList, this.resultWrap);\r\n\r\n    // remove result when lengh = 0 and insertToInput is false\r\n    if ((this.matches?.length == 0 && !this.toInput) || this.showAll) {\r\n      this.resultList.innerHTML = \"\";\r\n    }\r\n\r\n    // set index\r\n    this.index = this.selectFirst ? 0 : -1;\r\n\r\n    // callback function\r\n    this.onClose();\r\n  };\r\n\r\n  /**\r\n   * The async function gets the text from the search\r\n   * and returns the matching array\r\n   *\r\n   * @param {String} value\r\n   */\r\n  searchItem = (value) => {\r\n    this.value = value;\r\n\r\n    // if searching show loading icon\r\n    this.onLoading(true);\r\n\r\n    // hide button clear\r\n    showBtnToClearData(this.cBtn, this.destroy);\r\n\r\n    // if there is no value and clearButton is true\r\n    if (value.length == 0 && this.clearButton) {\r\n      this.cBtn.classList.add(\"hidden\");\r\n    }\r\n\r\n    // if declare characters more then value.len and showAll is false\r\n    // remove class isActive\r\n    if (this.characters > value.length && !this.showAll) {\r\n      this.onLoading();\r\n      return;\r\n    }\r\n\r\n    // callblack function onSearch\r\n    this.onSearch({ currentValue: value, element: this.root })\r\n      .then((result) => {\r\n        const rootValueLength = this.root.value.length;\r\n        const resultLength = result.length;\r\n        // set no result\r\n        this.matches = Array.isArray(result)\r\n          ? [...result]\r\n          : JSON.parse(JSON.stringify(result));\r\n\r\n        this.onLoading();\r\n        this.error();\r\n\r\n        // if use destroy() method\r\n        if (resultLength == 0 && rootValueLength == 0) {\r\n          this.cBtn.classList.add(\"hidden\");\r\n        }\r\n\r\n        if (resultLength == 0 && rootValueLength) {\r\n          this.root.classList.remove(\"auto-expanded\");\r\n          this.reset();\r\n          this.noResults({\r\n            element: this.root,\r\n            currentValue: value,\r\n            template: this.results,\r\n          });\r\n          this.events();\r\n        } else if (resultLength > 0 || isObject(result)) {\r\n          this.index = this.selectFirst ? 0 : -1;\r\n          this.results();\r\n          this.events();\r\n        }\r\n      })\r\n      .catch(() => {\r\n        this.onLoading();\r\n        this.reset();\r\n      });\r\n  };\r\n\r\n  /**\r\n   * Set or remove loading class\r\n   *\r\n   * @param {Boolean} type\r\n   */\r\n  onLoading = (type) =>\r\n    this.root.parentNode.classList[type ? \"add\" : \"remove\"](this.isLoading);\r\n\r\n  /**\r\n   * Set error class to the root element\r\n   */\r\n  error = () => this.root.classList.remove(this.err);\r\n\r\n  /**\r\n   * Events\r\n   */\r\n  events = () => {\r\n    const { root, resultList } = this;\r\n\r\n    // handle click on keydown [up, down, enter, tab, esc]\r\n    root.addEventListener(\"keydown\", this.handleKeys);\r\n\r\n    //\r\n    root.addEventListener(\"click\", this.handleShowItems);\r\n\r\n    // temporarily disabled mouseleave\r\n    [\"mousemove\", \"click\"].map((eventType) => {\r\n      resultList.addEventListener(eventType, this.handleMouse);\r\n    });\r\n\r\n    // close expanded items\r\n    document.addEventListener(\"click\", this.handleDocClick);\r\n  };\r\n\r\n  /**\r\n   * Results\r\n   *\r\n   * @param {HTMLElement|String} template - html or string returned from the function,\r\n   * look at the example - https://github.com/tomik23/autocomplete/blob/master/docs/js/examples/no-results.js#L30\r\n   */\r\n  results = (template) => {\r\n    // set attribute to root\r\n    setAttributes(this.root, {\r\n      \"aria-expanded\": \"true\",\r\n      addClass: `${this.prefix}-expanded`,\r\n    });\r\n\r\n    // add all found records to otput ul\r\n    this.resultList.innerHTML =\r\n      this.matches.length === 0\r\n        ? this.onResults({\r\n            currentValue: this.value,\r\n            matches: 0,\r\n            template,\r\n          })\r\n        : this.onResults({\r\n            currentValue: this.value,\r\n            matches: this.matches,\r\n            classGroup: this.classGroup,\r\n          });\r\n\r\n    this.resultWrap.classList.add(this.isActive);\r\n\r\n    const checkIfClassGroupExist = this.classGroup\r\n      ? `:not(.${this.classGroup})`\r\n      : \"\";\r\n\r\n    this.itemsLi = document.querySelectorAll(\r\n      `#${this.outputUl} > li${checkIfClassGroupExist}`\r\n    );\r\n\r\n    // select first element\r\n    this.selectFirstEl();\r\n\r\n    // action on open results\r\n    this.onOpened({\r\n      type: \"results\",\r\n      element: this.root,\r\n      results: this.resultList,\r\n    });\r\n\r\n    // adding role, tabindex and aria\r\n    addAriaToAllLiElements(this.itemsLi);\r\n\r\n    // move the view item to the first item\r\n    // this.resultList.scrollTop = 0;\r\n    scrollResultsToTop(this.resultList, this.resultWrap);\r\n  };\r\n\r\n  /**\r\n   * Hangle click on document\r\n   *\r\n   * @param {Event} object\r\n   */\r\n  handleDocClick = ({ target }) => {\r\n    let disableClose = null;\r\n\r\n    // if 'target' is a ul and 'disableCloseOnSelect'\r\n    // is a 'true' set 'disableClose' on true\r\n    if (\r\n      (target.closest(\"ul\") && this.disable) ||\r\n      // when class classDisableClose\r\n      // then do not not close results\r\n      target.closest(`.${this.prevClosing}`)\r\n    ) {\r\n      disableClose = true;\r\n    }\r\n\r\n    if (target.id !== this.id && !disableClose) {\r\n      this.reset();\r\n      return;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Select first element\r\n   */\r\n  selectFirstEl = () => {\r\n    const { index, activeList, selectedOption, selectFirst, root } = this;\r\n\r\n    this.remAria(document.querySelector(`.${activeList}`));\r\n\r\n    if (!selectFirst) {\r\n      return;\r\n    }\r\n\r\n    const { firstElementChild } = this.resultList;\r\n\r\n    const classSelectFirst =\r\n      this.classGroup && this.matches.length > 0 && selectFirst\r\n        ? firstElementChild.nextElementSibling\r\n        : firstElementChild;\r\n\r\n    // set attribute to first element\r\n    setAttributes(classSelectFirst, {\r\n      id: `${selectedOption}-0`,\r\n      addClass: activeList,\r\n      \"aria-selected\": \"true\",\r\n    });\r\n\r\n    // calback function onSelect when first element is true\r\n    this.onSelected({\r\n      index,\r\n      element: root,\r\n      object: this.matches[index],\r\n    });\r\n\r\n    // add fisrst element to root input\r\n    // temporarily turned off\r\n    // if (this.matches.length > 0 && this.toInput) {\r\n    //   this.addToInput(this.itemsLi[this.index]);\r\n    // }\r\n\r\n    // set aria active descendant\r\n    setAriaActivedescendant(root, `${selectedOption}-0`);\r\n\r\n    // scrollIntoView when press up/down arrows\r\n    // followActiveElement(\r\n    //   firstElementChild,\r\n    //   this.outputUl,\r\n    //   this.classGroup,\r\n    //   this.resultList\r\n    // );\r\n  };\r\n\r\n  /**\r\n   * Add/remove class or set attribute\r\n   * @param {HTMLElement} el\r\n   * @param {Object} object\r\n   */\r\n  setAttr = (el, object) => {\r\n    for (let key in object) {\r\n      if (key === \"addClass\") {\r\n        el.classList.add(object[key]);\r\n      } else if (key === \"removeClass\") {\r\n        el.classList.remove(object[key]);\r\n      } else {\r\n        el.setAttribute(key, object[key]);\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * show items when items.length > 0 and is not empty\r\n   */\r\n  handleShowItems = () => {\r\n    const { root, resultWrap, resultList, isActive } = this;\r\n\r\n    // if resultWrap is not active and resultList is not empty\r\n    if (\r\n      resultList.textContent.length > 0 &&\r\n      !resultWrap.classList.contains(isActive)\r\n    ) {\r\n      // set attribute to root\r\n      setAttributes(root, {\r\n        \"aria-expanded\": \"true\",\r\n        addClass: `${this.prefix}-expanded`,\r\n      });\r\n\r\n      // add isActive class to resultWrap\r\n      resultWrap.classList.add(isActive);\r\n\r\n      // move the view item to the first item\r\n      // this.resultList.scrollTop = 0;\r\n      scrollResultsToTop(resultList, resultWrap);\r\n\r\n      // select first element\r\n      this.selectFirstEl();\r\n\r\n      // callback function\r\n      this.onOpened({\r\n        type: \"showItems\",\r\n        element: root,\r\n        results: resultList,\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Adding text from the list when li is clicking\r\n   * or adding aria-selected to li elements\r\n   *\r\n   * @param {Event} event\r\n   */\r\n  handleMouse = (event) => {\r\n    event.preventDefault();\r\n\r\n    const { target, type } = event;\r\n    const targetClosest = target.closest(\"li\");\r\n    const targetClosestRole = targetClosest?.hasAttribute(\"role\");\r\n    const activeClass = this.activeList;\r\n    const activeClassElement = document.querySelector(`.${activeClass}`);\r\n\r\n    if (!targetClosest || !targetClosestRole) {\r\n      return;\r\n    }\r\n\r\n    // click on li get element\r\n    if (type === \"click\") {\r\n      // get text from clicked li\r\n      this.getTextFromLi(targetClosest);\r\n    }\r\n\r\n    if (\r\n      type === \"mousemove\" &&\r\n      !targetClosest.classList.contains(activeClass)\r\n    ) {\r\n      this.remAria(activeClassElement);\r\n\r\n      // add aria to li\r\n      this.setAria(targetClosest);\r\n      this.index = this.indexLiSelected(targetClosest);\r\n\r\n      this.onSelected({\r\n        index: this.index,\r\n        element: this.root,\r\n        object: this.matches[this.index],\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Get text from li on enter or click\r\n   *\r\n   * @param {HTMLElement} element\r\n   */\r\n  getTextFromLi = (element) => {\r\n    const { root, index, disable } = this;\r\n\r\n    if (!element || this.matches.length === 0) {\r\n      // set default settings\r\n      !disable && this.reset();\r\n\r\n      return;\r\n    }\r\n\r\n    // get first element from li and set it to root\r\n    getFirstElementFromLiAndAddToInput(element, root);\r\n\r\n    // onSubmit passing text to function\r\n    this.onSubmit({\r\n      index: index,\r\n      element: root,\r\n      object: this.matches[index],\r\n      results: this.resultList,\r\n    });\r\n\r\n    // set default settings\r\n    if (!disable) {\r\n      this.remAria(element);\r\n      this.reset();\r\n    }\r\n\r\n    // show clearBtn when select element\r\n    this.clearButton && this.cBtn.classList.remove(\"hidden\");\r\n\r\n    // remove cache\r\n    this.cacheAct(\"remove\");\r\n  };\r\n\r\n  /**\r\n   * Return which li element was selected\r\n   * by hovering the mouse over\r\n   *\r\n   * @param {HTMLElement} target\r\n   * @returns {Number}\r\n   */\r\n  indexLiSelected = (target) =>\r\n    // get index of li element\r\n    Array.prototype.indexOf.call(this.itemsLi, target);\r\n\r\n  /**\r\n   * Navigating the elements li and enter\r\n   *\r\n   * @param {Event} event\r\n   */\r\n  handleKeys = (event) => {\r\n    const { root } = this;\r\n    const { keyCode } = event;\r\n\r\n    const resultList = this.resultWrap.classList.contains(this.isActive);\r\n\r\n    const matchesLength = this.matches.length + 1;\r\n    this.selectedLi = document.querySelector(`.${this.activeList}`);\r\n\r\n    // switch between keys\r\n    switch (keyCode) {\r\n      case keyCodes.UP:\r\n      case keyCodes.DOWN:\r\n        // Wrong cursor position in the input field #62\r\n        // Prevents the cursor from moving to the beginning\r\n        // of input as the cursor hovers over the results.\r\n        event.preventDefault();\r\n\r\n        if ((matchesLength <= 1 && this.selectFirst) || !resultList) {\r\n          return;\r\n        }\r\n\r\n        // if keyCode is up\r\n        if (keyCode === keyCodes.UP) {\r\n          if (this.index < 0) {\r\n            this.index = matchesLength - 1;\r\n          }\r\n          this.index -= 1;\r\n        } else {\r\n          this.index += 1;\r\n          if (this.index >= matchesLength) {\r\n            this.index = 0;\r\n          }\r\n        }\r\n\r\n        // remove aria-selected\r\n        this.remAria(this.selectedLi);\r\n\r\n        if (\r\n          matchesLength > 0 &&\r\n          this.index >= 0 &&\r\n          this.index < matchesLength - 1\r\n        ) {\r\n          // callback function\r\n          this.onSelected({\r\n            index: this.index,\r\n            element: root,\r\n            object: this.matches[this.index],\r\n          });\r\n\r\n          // set aria-selected\r\n          this.setAria(this.itemsLi[this.index]);\r\n          if (this.toInput && resultList) {\r\n            getFirstElementFromLiAndAddToInput(this.itemsLi[this.index], root);\r\n          }\r\n        } else {\r\n          // catch action\r\n          this.cacheAct();\r\n          setAriaActivedescendant(root);\r\n        }\r\n\r\n        break;\r\n      // keycode enter\r\n      case keyCodes.ENTER:\r\n        this.getTextFromLi(this.selectedLi);\r\n        break;\r\n\r\n      // keycode escape and keycode tab\r\n      case keyCodes.TAB:\r\n      case keyCodes.ESC:\r\n        event.stopPropagation(); // #120\r\n        this.reset();\r\n\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Set aria label on item li\r\n   *\r\n   * @param {HTMLElement} target\r\n   */\r\n  setAria = (target) => {\r\n    const selectedOption = `${this.selectedOption}-${this.indexLiSelected(\r\n      target\r\n    )}`;\r\n\r\n    // set aria to li\r\n    setAttributes(target, {\r\n      id: selectedOption,\r\n      \"aria-selected\": \"true\",\r\n      addClass: this.activeList,\r\n    });\r\n\r\n    setAriaActivedescendant(this.root, selectedOption);\r\n\r\n    // scrollIntoView when press up/down arrows\r\n    followActiveElement(\r\n      target,\r\n      this.outputUl,\r\n      this.classGroup,\r\n      this.resultList\r\n    );\r\n  };\r\n\r\n  /**\r\n   * Remove aria label from item li\r\n   *\r\n   * @param {HTMLElement} element\r\n   */\r\n  remAria = (element) => {\r\n    if (!element) return;\r\n\r\n    // remove aria from li\r\n    setAttributes(element, {\r\n      id: \"\",\r\n      removeClass: this.activeList,\r\n      \"aria-selected\": \"false\",\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Create clear button and\r\n   * removing text from the input field\r\n   */\r\n  clearbutton = () => {\r\n    // stop when clear button is disabled\r\n    if (!this.clearButton) return;\r\n\r\n    const { cBtn } = this;\r\n\r\n    // add aria to clear button\r\n    setAttributes(cBtn, {\r\n      class: `${this.prefix}-clear hidden`,\r\n      type: \"button\",\r\n      \"aria-label\": this.clearBtnAriLabel,\r\n    });\r\n\r\n    // insert clear button after input - root\r\n    this.root.insertAdjacentElement(\"afterend\", cBtn);\r\n  };\r\n\r\n  /**\r\n   * Clicking on the clear button\r\n   * publick destroy method\r\n   */\r\n  destroy = () => {\r\n    const { root } = this;\r\n    // if clear button is true then add class hidden\r\n    this.clearButton && this.cBtn.classList.add(\"hidden\");\r\n    // clear value searchId\r\n    root.value = \"\";\r\n    // set focus\r\n    root.focus();\r\n    // remove li from ul\r\n    this.resultList.textContent = \"\";\r\n    // set default aria\r\n    this.reset();\r\n    // remove error if exist\r\n    this.error();\r\n\r\n    // callback function\r\n    this.onReset(root);\r\n\r\n    // remove listener\r\n    root.removeEventListener(\"keydown\", this.handleKeys);\r\n    root.removeEventListener(\"click\", this.handleShowItems);\r\n    // remove listener on click on document\r\n    document.removeEventListener(\"click\", this.handleDocClick);\r\n  };\r\n}\r\n"],"names":["isObject","value","constructor","Object","isPromise","Boolean","then","setAttributes","el","object","key","classList","add","remove","setAttribute","getFirstElement","element","firstElementChild","getFirstElementFromLiAndAddToInput","root","textContent","trim","scrollResultsToTop","resultList","resultWrap","scrollTop","offsetTop","offsetHeight","addAriaToAllLiElements","itemsLi","i","length","role","tabindex","showBtnToClearData","clearButton","destroy","addEventListener","setAriaActivedescendant","type","getClassGroupHeight","outputUl","classGroup","allLi","document","querySelectorAll","height","slice","call","map","followActiveElement","target","previusElement","previousSibling","previusElementHeight","getAttribute","offsetBottom","scrollBottom","output","prefix","id","tabIndex","addClass","insertAdjacentElement","parentNode","insertBefore","nextSibling","keyCodes","ESC","ENTER","UP","DOWN","TAB","Autocomplete","delay","howManyCharacters","selectFirst","insertToInput","showAllValues","cache","disableCloseOnSelect","classPreventClosing","classPrefix","ariaLabelClear","onSearch","onResults","onSubmit","onOpened","onReset","onRender","onClose","noResults","onSelectedItem","init","clearbutton","handleInput","showAll","results","cacheAct","cacheData","removeAttribute","regex","replace","clearTimeout","timeout","setTimeout","searchItem","reset","removeClass","isActive","matches","toInput","innerHTML","index","onLoading","cBtn","characters","currentValue","result","rootValueLength","resultLength","Array","isArray","JSON","parse","stringify","error","template","events","catch","isLoading","err","handleKeys","handleShowItems","eventType","handleMouse","handleDocClick","checkIfClassGroupExist","selectFirstEl","disableClose","closest","disable","prevClosing","activeList","selectedOption","remAria","querySelector","classSelectFirst","nextElementSibling","onSelected","setAttr","contains","event","preventDefault","targetClosest","targetClosestRole","hasAttribute","activeClass","activeClassElement","getTextFromLi","setAria","indexLiSelected","prototype","indexOf","keyCode","matchesLength","selectedLi","stopPropagation","class","clearBtnAriLabel","focus","removeEventListener","getElementById","Promise","resolve","createElement"],"mappings":"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"}