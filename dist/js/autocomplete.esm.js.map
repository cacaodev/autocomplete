{"version":3,"file":"autocomplete.esm.js","sources":["../../sources/js/utils/function.js","../../sources/js/utils/keyCodes.js","../../sources/js/script.js"],"sourcesContent":["/**\r\n * Check is a Object\r\n * @param {Object} value\r\n * @returns {Boolean}\r\n */\r\nconst isObject = (value) =>\r\n  value && typeof value === \"object\" && value.constructor === Object;\r\n\r\n/**\r\n * Check if is a Promise\r\n * https://stackoverflow.com/a/53955664/10424385\r\n *\r\n * @param {Object} value\r\n * @returns {Boolean}\r\n */\r\nconst isPromise = (value) => Boolean(value && typeof value.then === \"function\");\r\n\r\n/**\r\n * Set attributes to element\r\n *\r\n * @param {HTMLElement} el\r\n * @param {Object} object\r\n */\r\nconst setAttributes = (el, object) => {\r\n  for (let key in object) {\r\n    if (key === \"addClass\") {\r\n      el.classList.add(object[key]);\r\n    } else if (key === \"removeClass\") {\r\n      el.classList.remove(object[key]);\r\n    } else {\r\n      el.setAttribute(key, object[key]);\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Get first element from child\r\n *\r\n * @param {HTMLElement} element\r\n * @returns {HTMLELement}\r\n */\r\nconst getFirstElement = (element) => element.firstElementChild || element;\r\n\r\n/**\r\n * Set data from li to input\r\n *\r\n * @param {String} element\r\n * @param {HTMLElement} root\r\n * @returns {String}\r\n */\r\nconst getFirstElementFromLiAndAddToInput = (element, root) =>\r\n  // get first element from li and add to input\r\n  (root.value = getFirstElement(element).textContent.trim());\r\n\r\n/**\r\n * Scroll to top result-list\r\n * @param {HTMLElement} resultList\r\n * @param {HTMLElement} resultWrap\r\n */\r\nconst scrollResultsToTop = (resultList, resultWrap) => {\r\n  // if there is an overflow of ul element, after\r\n  // opening we always move ul to the top of the results\r\n  resultList.scrollTop = resultList.offsetTop - resultWrap.offsetHeight;\r\n};\r\n\r\n/**\r\n * Adding role, tabindex, aria and call handleMouse\r\n *\r\n * @param {HTMLElement} itemsLi\r\n */\r\nconst addAriaToAllLiElements = (itemsLi) => {\r\n  // add role to all li elements\r\n  for (let i = 0; i < itemsLi.length; i++) {\r\n    setAttributes(itemsLi[i], {\r\n      role: \"option\",\r\n      tabindex: \"-1\",\r\n      \"aria-selected\": \"false\",\r\n      \"aria-setsize\": itemsLi.length,\r\n      \"aria-posinset\": i,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Show btn to clear data\r\n *\r\n * @param {HTMLElement} clearButton - button to clear data\r\n * @param {Function} destroy - destroy function\r\n */\r\nconst showBtnToClearData = (clearButton = false, destroy) => {\r\n  if (!clearButton) return;\r\n\r\n  clearButton.classList.remove(\"hidden\");\r\n  // add event to clear button\r\n  clearButton.addEventListener(\"click\", destroy);\r\n};\r\n\r\n/**\r\n * Set aria-activedescendant\r\n *\r\n * @param {HTMLElement} root - search input\r\n * @param {String} type\r\n */\r\nconst setAriaActivedescendant = (root, type) => {\r\n  root.setAttribute(\"aria-activedescendant\", type || \"\");\r\n};\r\n\r\n/**\r\n * Get height of ul without group class\r\n *\r\n * @param {String} outputUl\r\n * @param {String} classGroup\r\n * @returns {Number}\r\n */\r\nconst getClassGroupHeight = (outputUl, classGroup) => {\r\n  // get height of ul without group class\r\n  const allLi = document.querySelectorAll(\r\n    `#${outputUl} > li:not(.${classGroup})`\r\n  );\r\n  let height = 0;\r\n  [].slice.call(allLi).map((el) => (height += el.offsetHeight));\r\n\r\n  // return height\r\n  return height;\r\n};\r\n\r\n/**\r\n * Scroll into view when press up/down arrows\r\n *\r\n * @param {HTMLElement} target\r\n * @param {HTMLElement} outputUl\r\n * @param {String} classGroup\r\n * @param {HTMLElement} resultList\r\n */\r\nconst followActiveElement = (target, outputUl, classGroup, resultList) => {\r\n  const previusElement = resultList.previousSibling;\r\n\r\n  const previusElementHeight = previusElement ? previusElement.offsetHeight : 0;\r\n\r\n  if (target.getAttribute(\"aria-posinset\") == \"0\") {\r\n    resultList.scrollTop =\r\n      target.offsetTop - getClassGroupHeight(outputUl, classGroup);\r\n  }\r\n\r\n  if (target.offsetTop - previusElementHeight < resultList.scrollTop) {\r\n    resultList.scrollTop = target.offsetTop - previusElementHeight;\r\n  } else {\r\n    const offsetBottom =\r\n      target.offsetTop + target.offsetHeight - previusElementHeight;\r\n    const scrollBottom = resultList.scrollTop + resultList.offsetHeight;\r\n    if (offsetBottom > scrollBottom) {\r\n      resultList.scrollTop = offsetBottom - resultList.offsetHeight;\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Create output-list and put after search input\r\n *\r\n * @param {HTMLElement} root - search input\r\n * @param {HTMLElement} resultList - output-list ul\r\n * @param {String} outputUl - id name of output-list\r\n * @param {HTMLElement} resultWrap - wrapper ul element\r\n * @param {String} prefix - add prefix to all class auto\r\n */\r\nconst output = (root, resultList, outputUl, resultWrap, prefix) => {\r\n  // set attribute to results-list\r\n  setAttributes(resultList, {\r\n    id: outputUl,\r\n    tabIndex: \"0\",\r\n    role: \"listbox\",\r\n  });\r\n\r\n  // add class to wrap element\r\n  setAttributes(resultWrap, {\r\n    addClass: `${prefix}-results-wrapper`,\r\n  });\r\n\r\n  // insert the results into the wrap element\r\n  resultWrap.insertAdjacentElement(\"beforeend\", resultList);\r\n\r\n  // insert the wrap element after the search input\r\n  root.parentNode.insertBefore(resultWrap, root.nextSibling);\r\n};\r\n\r\n/**\r\n * Create element\r\n *\r\n * @param {String} type - type of element\r\n * @returns {HTMLDivElement}\r\n */\r\nconst createElement = (type) => document.createElement(type);\r\n\r\nexport {\r\n  addAriaToAllLiElements,\r\n  createElement,\r\n  followActiveElement,\r\n  getFirstElementFromLiAndAddToInput,\r\n  isObject,\r\n  isPromise,\r\n  output,\r\n  scrollResultsToTop,\r\n  setAriaActivedescendant,\r\n  setAttributes,\r\n  showBtnToClearData,\r\n};\r\n","/**\r\n * Key codes\r\n */\r\nconst keyCodes = {\r\n  ESC: 27,\r\n  ENTER: 13,\r\n  UP: 38,\r\n  DOWN: 40,\r\n  TAB: 9,\r\n};\r\n\r\nexport default keyCodes;\r\n","import {\r\n  addAriaToAllLiElements,\r\n  createElement,\r\n  followActiveElement,\r\n  getFirstElementFromLiAndAddToInput,\r\n  isObject,\r\n  isPromise,\r\n  output,\r\n  scrollResultsToTop,\r\n  setAriaActivedescendant,\r\n  setAttributes,\r\n  showBtnToClearData,\r\n} from \"./utils/function\";\r\n\r\nimport keyCodes from \"./utils/keyCodes\";\r\n\r\n/**\r\n * @class Autocomplete\r\n */\r\nexport default class Autocomplete {\r\n  /**\r\n   * Constructor\r\n   *\r\n   * @param {String} element\r\n   * @param {Object} object\r\n   */\r\n  constructor(\r\n    element,\r\n    {\r\n      delay = 500,\r\n      clearButton = true,\r\n      howManyCharacters = 1,\r\n      selectFirst = false,\r\n      insertToInput = false,\r\n      showAllValues = false,\r\n      cache = false,\r\n      disableCloseOnSelect = false,\r\n      classGroup,\r\n      classPreventClosing,\r\n      classPrefix,\r\n      ariaLabelClear,\r\n      onSearch,\r\n      onResults = () => {},\r\n      onSubmit = () => {},\r\n      onOpened = () => {},\r\n      onReset = () => {},\r\n      onRender = () => {},\r\n      onClose = () => {},\r\n      noResults = () => {},\r\n      onSelectedItem = () => {},\r\n    }\r\n  ) {\r\n    this._id = element;\r\n    this._root = document.getElementById(element);\r\n    this._onSearch = isPromise(onSearch)\r\n      ? onSearch\r\n      : ({ currentValue, element }) =>\r\n          Promise.resolve(onSearch({ currentValue, element }));\r\n    this._onResults = onResults;\r\n    this._onRender = onRender;\r\n    this._onSubmit = onSubmit;\r\n    this._onSelected = onSelectedItem;\r\n    this._onOpened = onOpened;\r\n    this._onReset = onReset;\r\n    this._noResults = noResults;\r\n    this._onClose = onClose;\r\n\r\n    this._delay = delay;\r\n    this._characters = howManyCharacters;\r\n    this._clearButton = clearButton;\r\n    this._selectFirst = selectFirst;\r\n    this._toInput = insertToInput;\r\n    this._showAll = showAllValues;\r\n    this._classGroup = classGroup;\r\n    this._prevClosing = classPreventClosing;\r\n    this._clearBtnAriLabel = ariaLabelClear\r\n      ? ariaLabelClear\r\n      : \"clear the search query\";\r\n    this._prefix = classPrefix ? `${classPrefix}-auto` : \"auto\";\r\n    this._disable = disableCloseOnSelect;\r\n\r\n    // default config\r\n    this._cache = cache;\r\n    this._outputUl = `${this._prefix}-${this._id}-results`;\r\n    this._cacheData = `data-cache-auto-${this._id}`;\r\n    this._isLoading = `${this._prefix}-is-loading`;\r\n    this._isActive = `${this._prefix}-is-active`;\r\n    this._activeList = `${this._prefix}-selected`;\r\n    this._selectedOption = `${this._prefix}-selected-option`;\r\n    this._err = `${this._prefix}-error`;\r\n    this._regex = /[|\\\\{}()[\\]^$+*?.]/g;\r\n    this._timeout = null;\r\n\r\n    this._resultWrap = createElement(\"div\");\r\n    this._resultList = createElement(\"ul\");\r\n    this._cBtn = createElement(\"button\");\r\n\r\n    this._initial();\r\n  }\r\n\r\n  /**\r\n   * Initial function\r\n   */\r\n  _initial = () => {\r\n    this._clearbutton();\r\n\r\n    output(\r\n      this._root,\r\n      this._resultList,\r\n      this._outputUl,\r\n      this._resultWrap,\r\n      this._prefix\r\n    );\r\n\r\n    // default aria\r\n    // this.reset();\r\n    this._root.addEventListener(\"input\", this._handleInput);\r\n\r\n    // show all values on click root input\r\n    this._showAll && this._root.addEventListener(\"click\", this._handleInput);\r\n\r\n    // calback functions\r\n    this._onRender({\r\n      element: this._root,\r\n      results: this._resultList,\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Actions on input\r\n   *\r\n   * @param {String} type - set attribute depending on type\r\n   * @param {String} target\r\n   */\r\n  _cacheAct = (type, target) => {\r\n    if (!this._cache) return;\r\n\r\n    if (type === \"update\") {\r\n      this._root.setAttribute(this._cacheData, target.value);\r\n    } else if (type === \"remove\") {\r\n      this._root.removeAttribute(this._cacheData);\r\n    } else {\r\n      this._root.value = this._root.getAttribute(this._cacheData);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handle input\r\n   *\r\n   * @param {Event} object\r\n   */\r\n  _handleInput = ({ target, type }) => {\r\n    if (\r\n      this._root.getAttribute(\"aria-expanded\") === \"true\" &&\r\n      type === \"click\"\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    // replace all special characters\r\n    const regex = target.value.replace(this._regex, \"\\\\$&\");\r\n\r\n    // update data attribute cache\r\n    this._cacheAct(\"update\", target);\r\n\r\n    const delay = this._showAll ? 0 : this._delay;\r\n    // clear timeout\r\n    clearTimeout(this._timeout);\r\n    this._timeout = setTimeout(() => {\r\n      this._searchItem(regex.trim());\r\n    }, delay);\r\n  };\r\n\r\n  /**\r\n   * Default aria\r\n   */\r\n  _reset = () => {\r\n    // set attributes to root - input\r\n    setAttributes(this._root, {\r\n      \"aria-owns\": `${this._id}-list`,\r\n      \"aria-expanded\": \"false\",\r\n      \"aria-autocomplete\": \"list\",\r\n      \"aria-activedescendant\": \"\",\r\n      role: \"combobox\",\r\n      removeClass: \"auto-expanded\",\r\n    });\r\n\r\n    // remove class isActive\r\n    this._resultWrap.classList.remove(this._isActive);\r\n\r\n    // move the view item to the first item\r\n    // this.resultList.scrollTop = 0;\r\n    // scrollResultsToTop(this.resultList, this.resultWrap);\r\n\r\n    // remove result when lengh = 0 and insertToInput is false\r\n    if ((this._matches?.length == 0 && !this._toInput) || this._showAll) {\r\n      this._resultList.innerHTML = \"\";\r\n    }\r\n\r\n    // set index\r\n    this._index = this._selectFirst ? 0 : -1;\r\n\r\n    // callback function\r\n    this._onClose();\r\n  };\r\n\r\n  /**\r\n   * The async function gets the text from the search\r\n   * and returns the matching array\r\n   *\r\n   * @param {String} value\r\n   */\r\n  _searchItem = (value) => {\r\n    this._value = value;\r\n\r\n    // if searching show loading icon\r\n    this._onLoading(true);\r\n\r\n    // hide button clear\r\n    showBtnToClearData(this._cBtn, this.destroy);\r\n\r\n    // if there is no value and clearButton is true\r\n    if (value.length == 0 && this._clearButton) {\r\n      this._cBtn.classList.add(\"hidden\");\r\n    }\r\n\r\n    // if declare characters more then value.len and showAll is false\r\n    // remove class isActive\r\n    if (this._characters > value.length && !this._showAll) {\r\n      this._onLoading();\r\n      return;\r\n    }\r\n\r\n    // callblack function onSearch\r\n    this._onSearch({ currentValue: value, element: this._root })\r\n      .then((result) => {\r\n        const rootValueLength = this._root.value.length;\r\n        const resultLength = result.length;\r\n        // set no result\r\n        this._matches = Array.isArray(result)\r\n          ? [...result]\r\n          : JSON.parse(JSON.stringify(result));\r\n\r\n        this._onLoading();\r\n        this._error();\r\n\r\n        // if use destroy() method\r\n        if (resultLength == 0 && rootValueLength == 0) {\r\n          this._cBtn.classList.add(\"hidden\");\r\n        }\r\n\r\n        if (resultLength == 0 && rootValueLength) {\r\n          this._root.classList.remove(\"auto-expanded\");\r\n          this._reset();\r\n          this._noResults({\r\n            element: this._root,\r\n            currentValue: value,\r\n            template: this._results,\r\n          });\r\n          this._events();\r\n        } else if (resultLength > 0 || isObject(result)) {\r\n          this._index = this._selectFirst ? 0 : -1;\r\n          this._results();\r\n          this._events();\r\n        }\r\n      })\r\n      .catch(() => {\r\n        this._onLoading();\r\n        this._reset();\r\n      });\r\n  };\r\n\r\n  /**\r\n   * Set or remove loading class\r\n   *\r\n   * @param {Boolean} type\r\n   */\r\n  _onLoading = (type) =>\r\n    this._root.parentNode.classList[type ? \"add\" : \"remove\"](this._isLoading);\r\n\r\n  /**\r\n   * Set error class to the root element\r\n   */\r\n  _error = () => this._root.classList.remove(this._err);\r\n\r\n  /**\r\n   * Events\r\n   */\r\n  _events = () => {\r\n    // handle click on keydown [up, down, enter, tab, esc]\r\n    this._root.addEventListener(\"keydown\", this._handleKeys);\r\n\r\n    //\r\n    this._root.addEventListener(\"click\", this._handleShowItems);\r\n\r\n    // temporarily disabled mouseleave\r\n    [\"mousemove\", \"click\"].map((eventType) => {\r\n      this._resultList.addEventListener(eventType, this._handleMouse);\r\n    });\r\n\r\n    // close expanded items\r\n    document.addEventListener(\"click\", this._handleDocClick);\r\n  };\r\n\r\n  /**\r\n   * Results\r\n   *\r\n   * @param {HTMLElement|String} template - html or string returned from the function,\r\n   * look at the example - https://github.com/tomik23/autocomplete/blob/master/docs/js/examples/no-results.js#L30\r\n   */\r\n  _results = (template) => {\r\n    // set attribute to root\r\n    setAttributes(this._root, {\r\n      \"aria-expanded\": \"true\",\r\n      addClass: `${this._prefix}-expanded`,\r\n    });\r\n\r\n    // add all found records to otput ul\r\n    this._resultList.innerHTML =\r\n      this._matches.length === 0\r\n        ? this._onResults({\r\n            currentValue: this._value,\r\n            matches: 0,\r\n            template,\r\n          })\r\n        : this._onResults({\r\n            currentValue: this._value,\r\n            matches: this._matches,\r\n            classGroup: this._classGroup,\r\n          });\r\n\r\n    this._resultWrap.classList.add(this._isActive);\r\n\r\n    const checkIfClassGroupExist = this._classGroup\r\n      ? `:not(.${this._classGroup})`\r\n      : \"\";\r\n\r\n    this._itemsLi = document.querySelectorAll(\r\n      `#${this._outputUl} > li${checkIfClassGroupExist}`\r\n    );\r\n\r\n    // adding role, tabindex and aria\r\n    addAriaToAllLiElements(this._itemsLi);\r\n\r\n    // action on open results\r\n    this._onOpened({\r\n      type: \"results\",\r\n      element: this._root,\r\n      results: this._resultList,\r\n    });\r\n\r\n    // select first element\r\n    this._selectFirstEl();\r\n\r\n    // move the view item to the first item\r\n    // this.resultList.scrollTop = 0;\r\n    scrollResultsToTop(this._resultList, this._resultWrap);\r\n  };\r\n\r\n  /**\r\n   * Hangle click on document\r\n   *\r\n   * @param {Event} object\r\n   */\r\n  _handleDocClick = ({ target }) => {\r\n    let disableClose = null;\r\n\r\n    // if 'target' is a ul and 'disableCloseOnSelect'\r\n    // is a 'true' set 'disableClose' on true\r\n    if (\r\n      (target.closest(\"ul\") && this._disable) ||\r\n      // when class classDisableClose\r\n      // then do not not close results\r\n      target.closest(`.${this._prevClosing}`)\r\n    ) {\r\n      disableClose = true;\r\n    }\r\n\r\n    if (target.id !== this._id && !disableClose) {\r\n      this._reset();\r\n      return;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Select first element\r\n   */\r\n  _selectFirstEl = () => {\r\n    this._remAria(document.querySelector(`.${this._activeList}`));\r\n\r\n    if (!this._selectFirst) {\r\n      return;\r\n    }\r\n\r\n    const { firstElementChild } = this._resultList;\r\n\r\n    const classSelectFirst =\r\n      this._classGroup && this._matches.length > 0 && this._selectFirst\r\n        ? firstElementChild.nextElementSibling\r\n        : firstElementChild;\r\n\r\n    // calback function onSelect when first element is true\r\n    this._onSelected({\r\n      index: this._index,\r\n      element: this._root,\r\n      object: this._matches[this._index],\r\n    });\r\n\r\n    // set attribute to first element\r\n    setAttributes(classSelectFirst, {\r\n      id: `${this._selectedOption}-0`,\r\n      addClass: this._activeList,\r\n      \"aria-selected\": \"true\",\r\n    });\r\n\r\n    // set aria active descendant\r\n    setAriaActivedescendant(this._root, `${this._selectedOption}-0`);\r\n  };\r\n\r\n  /**\r\n   * show items when items.length > 0 and is not empty\r\n   */\r\n  _handleShowItems = () => {\r\n    // if resultWrap is not active and resultList is not empty\r\n    if (\r\n      this._resultList.textContent.length > 0 &&\r\n      !this._resultWrap.classList.contains(this._isActive)\r\n    ) {\r\n      // set attribute to root\r\n      setAttributes(this._root, {\r\n        \"aria-expanded\": \"true\",\r\n        addClass: `${this._prefix}-expanded`,\r\n      });\r\n\r\n      // add isActive class to resultWrap\r\n      this._resultWrap.classList.add(this._isActive);\r\n\r\n      // move the view item to the first item\r\n      // this.resultList.scrollTop = 0;\r\n      scrollResultsToTop(this._resultList, this._resultWrap);\r\n\r\n      // select first element\r\n      this._selectFirstEl();\r\n\r\n      // callback function\r\n      this._onOpened({\r\n        type: \"showItems\",\r\n        element: this._root,\r\n        results: this._resultList,\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Adding text from the list when li is clicking\r\n   * or adding aria-selected to li elements\r\n   *\r\n   * @param {Event} event\r\n   */\r\n  _handleMouse = (event) => {\r\n    event.preventDefault();\r\n\r\n    const { target, type } = event;\r\n    const targetClosest = target.closest(\"li\");\r\n    const targetClosestRole = targetClosest?.hasAttribute(\"role\");\r\n    const activeClass = this._activeList;\r\n    const activeClassElement = document.querySelector(`.${activeClass}`);\r\n\r\n    if (!targetClosest || !targetClosestRole) {\r\n      return;\r\n    }\r\n\r\n    // click on li get element\r\n    if (type === \"click\") {\r\n      // get text from clicked li\r\n      this._getTextFromLi(targetClosest);\r\n    }\r\n\r\n    if (\r\n      type === \"mousemove\" &&\r\n      !targetClosest.classList.contains(activeClass)\r\n    ) {\r\n      this._remAria(activeClassElement);\r\n\r\n      // add aria to li\r\n      this._setAria(targetClosest);\r\n      this._index = this._indexLiSelected(targetClosest);\r\n\r\n      this._onSelected({\r\n        index: this._index,\r\n        element: this._root,\r\n        object: this._matches[this._index],\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Get text from li on enter or click\r\n   *\r\n   * @param {HTMLElement} element\r\n   */\r\n  _getTextFromLi = (element) => {\r\n    if (!element || this._matches.length === 0) {\r\n      // set default settings\r\n      !this._disable && this._reset();\r\n\r\n      return;\r\n    }\r\n\r\n    // get first element from li and set it to root\r\n    getFirstElementFromLiAndAddToInput(element, this._root);\r\n\r\n    // onSubmit passing text to function\r\n    this._onSubmit({\r\n      index: this._index,\r\n      element: this._root,\r\n      object: this._matches[this._index],\r\n      results: this._resultList,\r\n    });\r\n\r\n    // set default settings\r\n    if (!this._disable) {\r\n      this._remAria(element);\r\n      this._reset();\r\n    }\r\n\r\n    // show clearBtn when select element\r\n    this._clearButton && this._cBtn.classList.remove(\"hidden\");\r\n\r\n    // remove cache\r\n    this._cacheAct(\"remove\");\r\n  };\r\n\r\n  /**\r\n   * Return which li element was selected\r\n   * by hovering the mouse over\r\n   *\r\n   * @param {HTMLElement} target\r\n   * @returns {Number}\r\n   */\r\n  _indexLiSelected = (target) =>\r\n    // get index of li element\r\n    Array.prototype.indexOf.call(this._itemsLi, target);\r\n\r\n  /**\r\n   * Navigating the elements li and enter\r\n   *\r\n   * @param {Event} event\r\n   */\r\n  _handleKeys = (event) => {\r\n    const { keyCode } = event;\r\n\r\n    const resultList = this._resultWrap.classList.contains(this._isActive);\r\n\r\n    const matchesLength = this._matches.length + 1;\r\n    this._selectedLi = document.querySelector(`.${this._activeList}`);\r\n\r\n    // switch between keys\r\n    switch (keyCode) {\r\n      case keyCodes.UP:\r\n      case keyCodes.DOWN:\r\n        // Wrong cursor position in the input field #62\r\n        // Prevents the cursor from moving to the beginning\r\n        // of input as the cursor hovers over the results.\r\n        event.preventDefault();\r\n\r\n        if ((matchesLength <= 1 && this._selectFirst) || !resultList) {\r\n          return;\r\n        }\r\n\r\n        // if keyCode is up\r\n        if (keyCode === keyCodes.UP) {\r\n          if (this._index < 0) {\r\n            this._index = matchesLength - 1;\r\n          }\r\n          this._index -= 1;\r\n        } else {\r\n          this._index += 1;\r\n          if (this._index >= matchesLength) {\r\n            this._index = 0;\r\n          }\r\n        }\r\n\r\n        // remove aria-selected\r\n        this._remAria(this._selectedLi);\r\n\r\n        if (\r\n          matchesLength > 0 &&\r\n          this._index >= 0 &&\r\n          this._index < matchesLength - 1\r\n        ) {\r\n          if (this._toInput && resultList) {\r\n            getFirstElementFromLiAndAddToInput(\r\n              this._itemsLi[this._index],\r\n              this._root\r\n            );\r\n          }\r\n\r\n          // callback function\r\n          this._onSelected({\r\n            index: this._index,\r\n            element: this._root,\r\n            object: this._matches[this._index],\r\n          });\r\n\r\n          // set aria-selected\r\n          this._setAria(this._itemsLi[this._index]);\r\n        } else {\r\n          // catch action\r\n          this._cacheAct();\r\n          setAriaActivedescendant(this._root);\r\n\r\n          this._onSelected({\r\n            index: null,\r\n            element: this._root,\r\n            object: null,\r\n          });\r\n        }\r\n\r\n        break;\r\n      // keycode enter\r\n      case keyCodes.ENTER:\r\n        this._getTextFromLi(this._selectedLi);\r\n        break;\r\n\r\n      // keycode escape and keycode tab\r\n      case keyCodes.TAB:\r\n      case keyCodes.ESC:\r\n        event.stopPropagation(); // #120\r\n        this._reset();\r\n\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Set aria label on item li\r\n   *\r\n   * @param {HTMLElement} target\r\n   */\r\n  _setAria = (target) => {\r\n    const selectedOption = `${this._selectedOption}-${this._indexLiSelected(\r\n      target\r\n    )}`;\r\n\r\n    // set aria to li\r\n    setAttributes(target, {\r\n      id: selectedOption,\r\n      \"aria-selected\": \"true\",\r\n      addClass: this._activeList,\r\n    });\r\n\r\n    setAriaActivedescendant(this._root, selectedOption);\r\n\r\n    // scrollIntoView when press up/down arrows\r\n    followActiveElement(\r\n      target,\r\n      this._outputUl,\r\n      this._classGroup,\r\n      this._resultList\r\n    );\r\n  };\r\n\r\n  /**\r\n   * Remove aria label from item li\r\n   *\r\n   * @param {HTMLElement} element\r\n   */\r\n  _remAria = (element) => {\r\n    if (!element) return;\r\n\r\n    // remove aria from li\r\n    setAttributes(element, {\r\n      id: \"\",\r\n      removeClass: this._activeList,\r\n      \"aria-selected\": \"false\",\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Create clear button and\r\n   * removing text from the input field\r\n   */\r\n  _clearbutton = () => {\r\n    // stop when clear button is disabled\r\n    if (!this._clearButton) return;\r\n\r\n    // add aria to clear button\r\n    setAttributes(this._cBtn, {\r\n      class: `${this._prefix}-clear hidden`,\r\n      type: \"button\",\r\n      title: this._clearBtnAriLabel,\r\n      \"aria-label\": this._clearBtnAriLabel,\r\n    });\r\n\r\n    // insert clear button after input - root\r\n    this._root.insertAdjacentElement(\"afterend\", this._cBtn);\r\n  };\r\n\r\n  /**\r\n   * Clicking on the clear button\r\n   * publick destroy method\r\n   */\r\n  destroy = () => {\r\n    // if clear button is true then add class hidden\r\n    this._clearButton && this._cBtn.classList.add(\"hidden\");\r\n    // clear value searchId\r\n    this._root.value = \"\";\r\n    // set focus\r\n    this._root.focus();\r\n    // remove li from ul\r\n    this._resultList.textContent = \"\";\r\n    // set default aria\r\n    this._reset();\r\n    // remove error if exist\r\n    this._error();\r\n\r\n    // callback function\r\n    this._onReset(this._root);\r\n\r\n    // remove listener\r\n    this._root.removeEventListener(\"keydown\", this._handleKeys);\r\n    this._root.removeEventListener(\"click\", this._handleShowItems);\r\n    // remove listener on click on document\r\n    document.removeEventListener(\"click\", this._handleDocClick);\r\n  };\r\n}\r\n"],"names":["isObject","value","constructor","Object","isPromise","Boolean","then","setAttributes","el","object","key","classList","add","remove","setAttribute","getFirstElement","element","firstElementChild","getFirstElementFromLiAndAddToInput","root","textContent","trim","scrollResultsToTop","resultList","resultWrap","scrollTop","offsetTop","offsetHeight","addAriaToAllLiElements","itemsLi","i","length","role","tabindex","showBtnToClearData","clearButton","destroy","addEventListener","setAriaActivedescendant","type","getClassGroupHeight","outputUl","classGroup","allLi","document","querySelectorAll","height","slice","call","map","followActiveElement","target","previusElement","previousSibling","previusElementHeight","getAttribute","offsetBottom","scrollBottom","output","prefix","id","tabIndex","addClass","insertAdjacentElement","parentNode","insertBefore","nextSibling","createElement","keyCodes","ESC","ENTER","UP","DOWN","TAB","Autocomplete","delay","howManyCharacters","selectFirst","insertToInput","showAllValues","cache","disableCloseOnSelect","classPreventClosing","classPrefix","ariaLabelClear","onSearch","onResults","onSubmit","onOpened","onReset","onRender","onClose","noResults","onSelectedItem","_initial","_clearbutton","_root","_resultList","_outputUl","_resultWrap","_prefix","_handleInput","_showAll","_onRender","results","_cacheAct","_cache","_cacheData","removeAttribute","regex","replace","_regex","_delay","clearTimeout","_timeout","setTimeout","_searchItem","_reset","_id","removeClass","_isActive","_matches","_toInput","innerHTML","_index","_selectFirst","_onClose","_value","_onLoading","_cBtn","_clearButton","_characters","_onSearch","currentValue","result","rootValueLength","resultLength","Array","isArray","JSON","parse","stringify","_error","_noResults","template","_results","_events","catch","_isLoading","_err","_handleKeys","_handleShowItems","eventType","_handleMouse","_handleDocClick","_onResults","matches","_classGroup","checkIfClassGroupExist","_itemsLi","_onOpened","_selectFirstEl","disableClose","closest","_disable","_prevClosing","_remAria","querySelector","_activeList","classSelectFirst","nextElementSibling","_onSelected","index","_selectedOption","contains","event","preventDefault","targetClosest","targetClosestRole","hasAttribute","activeClass","activeClassElement","_getTextFromLi","_setAria","_indexLiSelected","_onSubmit","prototype","indexOf","keyCode","matchesLength","_selectedLi","stopPropagation","selectedOption","class","title","_clearBtnAriLabel","focus","_onReset","removeEventListener","getElementById","Promise","resolve"],"mappings":"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"}