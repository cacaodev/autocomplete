var Autocomplete=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}return function s(i,o){var r,a=this,c=o.delay,l=o.clearButton,d=o.howManyCharacters,u=o.selectFirst,h=o.insertToInput,f=o.onResults,m=void 0===f?function(){}:f,v=o.onSearch,L=void 0===v?function(){}:v,p=o.onSubmit,y=void 0===p?function(){}:p,b=o.noResults,A=void 0===b?function(){}:b,S=o.onSelectedItem,g=void 0===S?function(){}:S;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t(this,"initialize",(function(){a.selectedIndex=a.selectFirst?0:-1,a.clearButton&&a.createClearButton(),a.outputSearch(),a.setDefault(),a.root.addEventListener("input",a.handleInput)})),t(this,"handleInput",(function(e){var t=e.target.value.replace(a.regex,"");clearTimeout(a.timeout),a.timeout=setTimeout((function(){a.searchItem(t.trim())}),a.delay)})),t(this,"outputSearch",(function(){a.resultList=document.createElement("ul"),a.setAttribute(a.resultList,{id:a.searchOutputUl,addClass:"auto-output-search",tabIndex:0,role:"listbox"}),a.root.parentNode.insertBefore(a.resultList,a.root.nextSibling)})),t(this,"setDefault",(function(){var e;a.setAttribute(a.root,{"aria-owns":"".concat(a.search,"-list"),"aria-expanded":!1,"aria-autocomplete":"both","aria-activedescendant":"",role:"combobox",removeClass:"expanded"}),a.resultList.classList.remove(a.isActive),a.resultList.scrollTop=0,0!=(null===(e=a.matches)||void 0===e?void 0:e.length)||a.insertToInput||(a.resultList.innerHTML=""),a.selectedIndex=a.selectFirst?0:-1})),t(this,"searchItem",(function(t){a.value=t,a.onLoading(!0),a.showHiddenButton(),a.howManyCharacters>t.length?a.onLoading():a.onSearch(t).then((function(s){var i;a.matches=Array.isArray(s)?n(s):JSON.parse(JSON.stringify(s)),a.onLoading(),a.onError(),a.handleEvents(),0==s.length?(a.root.classList.remove("expanded"),a.setDefault(),a.noResults(t,a.renderResults)):(s.length>0||(i=s)&&"object"===e(i)&&i.constructor===Object)&&a.renderResults()})).catch((function(){a.onLoading(),a.setDefault()}))})),t(this,"onLoading",(function(e){a.root.parentNode.classList[e?"add":"remove"](a.isLoading)})),t(this,"onError",(function(e){a.root.classList[e?"add":"remove"](a.error)})),t(this,"handleEvents",(function(){var e=[].slice.call(a.resultList.children);a.root.addEventListener("keydown",a.handleKeys),a.root.addEventListener("click",a.handleShowItems);for(var t=0;t<e.length;t++)e[t].addEventListener("mousemove",a.handleMouse),e[t].addEventListener("click",a.handleMouse);document.addEventListener("click",a.handleDocumentClick)})),t(this,"renderResults",(function(e){a.setAttribute(a.root,{"aria-expanded":!0,addClass:"expanded"}),a.resultList.innerHTML=0===a.matches.length?a.onResults(0,e):a.onResults(a.matches,a.value),a.resultList.classList.add(a.isActive),a.itemsLi=document.querySelectorAll("#".concat(a.searchOutputUl," > li")),a.selectFirstEl(),a.addAriaLabelToLi()})),t(this,"handleDocumentClick",(function(e){e.target.id===a.search||a.setDefault()})),t(this,"addAriaLabelToLi",(function(){for(var e=0;e<a.itemsLi.length;e++)a.setAttribute(a.itemsLi[e],{role:"option",tabindex:-1,"aria-selected":"false"})})),t(this,"selectFirstEl",(function(){if(a.removeAriaSelected(document.querySelector(".".concat(a.activeList))),a.selectFirst){var e=a.resultList.firstElementChild;a.setAttribute(e,{id:"".concat(a.selectedOption,"-0"),addClass:a.activeList,"aria-selected":!0}),a.setAriaDescendant(a.root,"".concat(a.selectedOption,"-0")),a.followElement(e,a.resultList)}})),t(this,"showHiddenButton",(function(){a.clearButton&&(a.clearButton.classList.remove("hidden"),a.clearButton.addEventListener("click",a.handleClearButton))})),t(this,"setAttribute",(function(e,t){for(var n in t)"addClass"===n?e.classList.add(t[n]):"removeClass"===n?e.classList.remove(t[n]):e.setAttribute(n,t[n])})),t(this,"handleShowItems",(function(){a.resultList.textContent.length>0&&(a.setAttribute(a.root,{"aria-expanded":!0,addClass:"expanded"}),a.resultList.classList.add(a.isActive),a.selectFirstEl())})),t(this,"handleMouse",(function(e){var t=e.target,n=e.type,s=t.closest("li");"click"===n&&a.getTextFromLi(s),s.classList.contains(a.activeList)||"mousemove"===n&&(a.removeAriaSelected(document.querySelector(".".concat(a.activeList))),a.setAriaSelectedItem(s),a.selectedIndex=a.indexLiSelected(s),a.onSelectedItem(a.selectedIndex,a.matches[a.selectedIndex]))})),t(this,"getTextFromLi",(function(e){e&&0!==a.matches.length&&(a.addDataToInput(e),a.removeAriaSelected(e),a.onSubmit(a.matches[a.selectedIndex],a.root.value),a.setDefault())})),t(this,"getFirstElement",(function(e){return e.firstElementChild||e})),t(this,"addDataToInput",(function(e){a.root.value=a.getFirstElement(e).textContent.trim()})),t(this,"indexLiSelected",(function(e){return Array.prototype.indexOf.call(a.itemsLi,e)})),t(this,"handleKeys",(function(e){var t=e.keyCode,n=a.resultList.classList.contains(a.isActive),s=a.matches.length;switch(a.selectedLi=document.querySelector(".".concat(a.activeList)),t){case a.keyCodes.UP:case a.keyCodes.DOWN:if(s<=1&&a.selectFirst||!n)return;t===a.keyCodes.UP?(a.selectedIndex-=1,a.selectedIndex<0&&(a.selectedIndex=s-1)):(a.selectedIndex+=1,a.selectedIndex>=s&&(a.selectedIndex=0)),a.removeAriaSelected(a.selectedLi),s>0&&(a.onSelectedItem(a.selectedIndex,a.matches[a.selectedIndex]),a.setAriaSelectedItem(a.itemsLi[a.selectedIndex]),a.insertToInput&&n&&a.addDataToInput(a.itemsLi[a.selectedIndex]));break;case a.keyCodes.ENTER:a.removeAriaSelected(a.selectedLi),a.getTextFromLi(a.selectedLi);break;case a.keyCodes.TAB:case a.keyCodes.ESC:a.setDefault()}})),t(this,"setAriaSelectedItem",(function(e){var t="".concat(a.selectedOption,"-").concat(a.indexLiSelected(e));a.setAttribute(e,{id:t,"aria-selected":!0,addClass:a.activeList}),a.setAriaDescendant(a.root,t),a.followElement(e,a.resultList)})),t(this,"followElement",(function(e,t){if(e.offsetTop<t.scrollTop)t.scrollTop=e.offsetTop;else{var n=e.offsetTop+e.offsetHeight;n>t.scrollTop+t.offsetHeight&&(t.scrollTop=n-t.offsetHeight)}})),t(this,"removeAriaSelected",(function(e){e&&a.setAttribute(e,{id:"",removeClass:a.activeList,"aria-selected":!1})})),t(this,"setAriaDescendant",(function(e,t){e.setAttribute("aria-activedescendant",t||"")})),t(this,"createClearButton",(function(){a.clearButton=document.createElement("button"),a.setAttribute(a.clearButton,{id:"auto-clear-".concat(a.search),class:"auto-clear hidden",type:"button","aria-label":"claar text from input"}),a.root.insertAdjacentElement("afterend",a.clearButton)})),t(this,"handleClearButton",(function(e){e.target.classList.add("hidden"),a.root.value="",a.root.focus(),a.resultList.textContent="",a.setDefault(),a.onError()})),this.search=i,this.root=document.getElementById(this.search),this.onResults=m,this.onSubmit=y,this.noResults=A,this.onSelectedItem=g,this.onSearch=(r=L,Boolean(r&&"function"==typeof r.then)?L:function(e){return Promise.resolve(L(e))}),this.delay=c||500,this.howManyCharacters=d||2,this.clearButton=l||!1,this.selectFirst=u||!1,this.insertToInput=h||!1,this.searchOutputUl="".concat(this.search,"-list"),this.isLoading="auto-is-loading",this.isActive="auto-is-active",this.activeList="auto-selected",this.selectedOption="selectedOption",this.error="auto-error",this.regex=/[`~!@#$%^&*()_|+\-=÷¿?;:'",.<>{}[\]\\/]/g,this.timeout=null,this.keyCodes={ESC:27,ENTER:13,UP:38,DOWN:40,TAB:9},this.initialize()}}();
